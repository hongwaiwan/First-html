<!DOCTYPE html>
<html>
<head>
  <title>Canvas Spreadsheet with Arrows</title>
  <style>
    #spreadsheetCanvas {
      border: 2px solid black;
      cursor: pointer;
    }
    input.cell-input {
      position: absolute;
      border: 1px solid #333;
      text-align: center;
      font-size: 16px;
      display: none;
    }
  </style>
</head>
<body>
  <h2>Canvas Spreadsheet (Arrow Navigation)</h2>
  <canvas id="spreadsheetCanvas" width="500" height="300"></canvas>
  <input type="text" id="cellInput" class="cell-input">

  <script>
    const canvas = document.getElementById('spreadsheetCanvas');
    const ctx = canvas.getContext('2d');
    const input = document.getElementById('cellInput');

    const rows = 5;
    const cols = 5;
    const cellWidth = 80;
    const cellHeight = 40;

    const cells = Array.from({ length: rows }, () => Array(cols).fill(''));

    let currentRow = 0;
    let currentCol = 0;

    function drawGrid() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.strokeStyle = '#000';
      ctx.font = '16px Arial';

      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          ctx.strokeRect(c * cellWidth, r * cellHeight, cellWidth, cellHeight);
          ctx.fillText(cells[r][c], c * cellWidth + 10, r * cellHeight + 25);
        }
      }

      // Highlight current cell
      ctx.strokeStyle = 'red';
      ctx.lineWidth = 2;
      ctx.strokeRect(currentCol * cellWidth, currentRow * cellHeight, cellWidth, cellHeight);
      ctx.lineWidth = 1; // reset
    }

    drawGrid();

    function showInput(row, col) {
      const rect = canvas.getBoundingClientRect();
      input.style.left = col * cellWidth + rect.left + 'px';
      input.style.top = row * cellHeight + rect.top + 'px';
      input.style.width = cellWidth + 'px';
      input.style.height = cellHeight + 'px';
      input.value = cells[row][col];
      input.style.display = 'block';
      input.focus();

      input.onblur = () => {
        cells[row][col] = input.value;
        input.style.display = 'none';
        drawGrid();
      };
    }

    // Click to select cell
    canvas.addEventListener('click', (e) => {
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      currentCol = Math.floor(x / cellWidth);
      currentRow = Math.floor(y / cellHeight);
      drawGrid();
      showInput(currentRow, currentCol);
    });

    // Arrow key navigation
    document.addEventListener('keydown', (e) => {
      if (input.style.display === 'block') return; // ignore while editing

      switch (e.key) {
        case 'ArrowUp':
          if (currentRow > 0) currentRow--;
          break;
        case 'ArrowDown':
          if (currentRow < rows - 1) currentRow++;
          break;
        case 'ArrowLeft':
          if (currentCol > 0) currentCol--;
          break;
        case 'ArrowRight':
          if (currentCol < cols - 1) currentCol++;
          break;
        case 'Enter':
          showInput(currentRow, currentCol);
          return; // skip redraw
      }
      drawGrid();
    });
  </script>
</body>
</html>
